{
  "info": {
    "_postman_id": "bf0242db-792a-4431-bf85-4e80ca9cc2f3",
    "name": "EDC-V Onboarding",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Setup Issuer",
      "item": [
        {
          "name": "Create Vault Access (Issuer)",
          "id": "937ce1ec-b856-49ce-9538-8b0c2267ad96",
          "request": {
            "auth": {
              "type": "oauth2",
              "oauth2": [
                {
                  "key": "tokenType",
                  "value": "Bearer",
                  "type": "string"
                },
                {
                  "key": "accessToken",
                  "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJXZGh2Vm5sYVloek11SUNPcE1feVJaZFJfYl9sUURSZFMyMkhVVm5uVzhFIn0.eyJleHAiOjE3NjM2NDExMDEsImlhdCI6MTc2MzY0MTA0MSwianRpIjoib25sdHJvOjBkZGMyNzZlLWQ1MzItMmFiMy02ZDIxLWVhOWYzNWIwNmVkYiIsImlzcyI6Imh0dHA6Ly9rZXljbG9hay5sb2NhbGhvc3QvcmVhbG1zL21hc3RlciIsInR5cCI6IkJlYXJlciIsImF6cCI6ImFkbWluLWNsaSIsInNpZCI6IjBhZDU1YWEwLWU3MjUtMzMyMi0wMjc3LTk2M2UzZjQ2YWRhYiIsInNjb3BlIjoicHJvZmlsZSBlbWFpbCJ9.dgh9X78A-3Zq50X-0-cjtgvgk7uaae1-DTlPI3ZIAZZ567Vs196PM7hXc2pYsdiWX2CCGr7SSaMPbK2dCwdb570s_Qd8a2o0bY4VfE53pmAwl9NyetVTNk-aEoOD399m8Qv8mYr8CYi983tIyrEIlQdsND1KqYFZWcxXMEB5OupG1YyBpNRXpUW7jOs1kEo_qTfx3x5vmFMqGejSkmBlP1YKi2RXjEOGjW7jBAuHlM39T6DAsTCoyR2ATAxmoF30zdbcRfm5QR0eRtM848nWqhiwA89wxtyLU-qODFpLXW0FqpVL9-7VSVuEKxWSZGwugl5NNK8gBuNJvktFt4WtuQ",
                  "type": "string"
                },
                {
                  "key": "password",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "clientSecret",
                  "value": "",
                  "type": "string"
                },
                {
                  "key": "clientId",
                  "value": "admin-cli",
                  "type": "string"
                },
                {
                  "key": "accessTokenUrl",
                  "value": "http://keycloak.localhost/realms/master/protocol/openid-connect/token",
                  "type": "string"
                },
                {
                  "key": "grant_type",
                  "value": "password_credentials",
                  "type": "string"
                },
                {
                  "key": "tokenName",
                  "value": "kc-admin-access",
                  "type": "string"
                },
                {
                  "key": "scope",
                  "value": "",
                  "type": "string"
                },
                {
                  "key": "username",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "addTokenTo",
                  "value": "header",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"clientId\": \"{{issuer_clientId}}\",\n    \"name\": \"Issuer Client\",\n    \"description\": \"Client for Vault Access (Issuer)\",\n    \"enabled\": true,\n    \"secret\": \"{{issuer_clientSecret}}\",\n    \"protocol\": \"openid-connect\",\n    \"publicClient\": false,\n    \"serviceAccountsEnabled\": true,\n    \"standardFlowEnabled\": false,\n    \"directAccessGrantsEnabled\": false,\n    \"fullScopeAllowed\": true,\n    \"protocolMappers\": [\n        {\n            \"name\": \"participantContextId\",\n            \"protocol\": \"openid-connect\",\n            \"protocolMapper\": \"oidc-hardcoded-claim-mapper\",\n            \"consentRequired\": false,\n            \"config\": {\n                \"claim.name\": \"participant_context_id\",\n                \"claim.value\": \"issuer\",\n                \"jsonType.label\": \"String\",\n                \"access.token.claim\": \"true\",\n                \"id.token.claim\": \"true\",\n                \"userinfo.token.claim\": \"true\"\n            }\n        },\n        {\n            \"name\": \"role\",\n            \"protocol\": \"openid-connect\",\n            \"protocolMapper\": \"oidc-hardcoded-claim-mapper\",\n            \"consentRequired\": false,\n            \"config\": {\n                \"claim.name\": \"role\",\n                \"claim.value\": \"participant\",\n                \"jsonType.label\": \"String\",\n                \"access.token.claim\": \"true\",\n                \"id.token.claim\": \"true\",\n                \"userinfo.token.claim\": \"true\"\n            }\n        }\n    ]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{KC_HOST}}/admin/realms/edcv/clients",
              "host": [
                "{{KC_HOST}}"
              ],
              "path": [
                "admin",
                "realms",
                "edcv",
                "clients"
              ]
            }
          }
        },
        {
          "name": "Create Tenant in IssuerService",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "f9bfd79a-0030-4a52-a86f-9949c7867d3c",
                "exec": [
                  "pm.test(\"Response contains apiKey, clientId and clientSecret\", function () {",
                  "    pm.expect(pm.response.json()).to.have.property(\"apiKey\");",
                  "})",
                  "let apiKey = pm.response.json().apiKey;",
                  "pm.collectionVariables.set(\"issuer_apiKey\", apiKey)"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "id": "59895aad-5f55-4397-a431-144f7e1a6ea5",
          "request": {
            "auth": {
              "type": "apikey",
              "apikey": [
                {
                  "key": "value",
                  "value": "c3VwZXItdXNlcg==.c3VwZXItc2VjcmV0LWtleQo=",
                  "type": "string"
                },
                {
                  "key": "key",
                  "value": "x-api-key",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"roles\": [\n        \"admin\"\n    ],\n    \"serviceEndpoints\": [\n        {\n            \"type\": \"IssuerService\",\n            \"serviceEndpoint\": \"http://issuerservice.edc-v.svc.cluster.local:10012/api/issuance/v1alpha/participants/aXNzdWVy\",\n            \"id\": \"issuer-service-1\"\n        }\n    ],\n    \"active\": true,\n    \"participantContextId\": \"issuer\",\n    \"did\": \"did:web:issuerservice.edc-v.svc.cluster.local%3A10016:issuer\",\n    \"key\": {\n        \"keyId\": \"did:web:issuerservice.edc-v.svc.cluster.local%3A10016:issuer#key-1\",\n        \"privateKeyAlias\": \"did:web:issuerservice.edc-v.svc.cluster.local%3A10016:issuer#key-1\",\n        \"keyGeneratorParams\": {\n            \"algorithm\": \"EdDSA\"\n        }\n    },\n    \"additionalProperties\":{\n       \"vaultConfig\": {\n            \"credentials\": {\n                \"clientId\": \"{{issuer_clientId}}\",\n                \"clientSecret\": \"{{issuer_clientSecret}}\",\n                \"tokenUrl\": \"http://keycloak.edc-v.svc.cluster.local:8080/realms/edcv/protocol/openid-connect/token\"\n            },\n            \"secretsPath\": \"v1/participants\",\n            \"folderPath\": \"{{issuer_clientId}}\",\n            \"vaultUrl\": \"http://vault.edc-v.svc.cluster.local:8200\"\n        }\n    }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/issuer/cs/api/identity/v1alpha/participants",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "issuer",
                "cs",
                "api",
                "identity",
                "v1alpha",
                "participants"
              ]
            }
          }
        },
        {
          "name": "Create AttestationDefinition",
          "id": "e160e916-ffb2-4297-90dc-6afb0b1efc56",
          "request": {
            "auth": {
              "type": "apikey",
              "apikey": [
                {
                  "key": "value",
                  "value": "{{issuer_apiKey}}",
                  "type": "string"
                },
                {
                  "key": "key",
                  "value": "x-api-key",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"attestationType\": \"membership\",\n    \"configuration\": {\n    },\n    \"id\": \"membership-attestation-def-1\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/issuer/admin/api/admin/v1alpha/participants/aXNzdWVy/attestations",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "issuer",
                "admin",
                "api",
                "admin",
                "v1alpha",
                "participants",
                "aXNzdWVy",
                "attestations"
              ]
            }
          }
        },
        {
          "name": "Create CredentialDefinition",
          "id": "d0d8e44d-241d-45bf-9b79-8406e5a9aa05",
          "request": {
            "auth": {
              "type": "apikey",
              "apikey": [
                {
                  "key": "value",
                  "value": "{{issuer_apiKey}}",
                  "type": "string"
                },
                {
                  "key": "key",
                  "value": "x-api-key",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"attestations\": [\n        \"membership-attestation-def-1\"\n    ],\n    \"credentialType\": \"MembershipCredential\",\n    \"id\": \"membership-credential-def\",\n    \"jsonSchema\": \"{}\",\n    \"jsonSchemaUrl\": \"https://example.com/schema/membership-credential.json\",\n    \"mappings\": [\n        {\n              \"input\": \"membership\",\n              \"output\": \"credentialSubject.membership\",\n              \"required\": true\n        },\n        {\n            \"input\": \"membershipType\",\n            \"output\": \"credentialSubject.membershipType\",\n            \"required\": \"true\"\n        },\n        {\n            \"input\": \"membershipStartDate\",\n            \"output\": \"credentialSubject.membershipStartDate\",\n            \"required\": true\n        }\n    ],\n    \"rules\": [],\n    \"format\": \"VC1_0_JWT\",\n    \"validity\": \"604800\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/issuer/admin/api/admin/v1alpha/participants/aXNzdWVy/credentialdefinitions",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "issuer",
                "admin",
                "api",
                "admin",
                "v1alpha",
                "participants",
                "aXNzdWVy",
                "credentialdefinitions"
              ]
            }
          }
        }
      ],
      "id": "d813e6d9-1886-4b02-a39e-91a0e32844f1"
    },
    {
      "name": "Create EDC-V ParticipantContext",
      "item": [
        {
          "name": "Create API Access (using Keycloak)",
          "id": "d78f5604-49f0-477a-936d-9926ffab506c",
          "request": {
            "auth": {
              "type": "oauth2",
              "oauth2": [
                {
                  "key": "tokenType",
                  "value": "Bearer",
                  "type": "string"
                },
                {
                  "key": "accessToken",
                  "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJHRzl0bHVwTDRpSmtvOEhhNHVNMlBNQ0k1RWt0R053M1J5ZGdKRTJ0RC1zIn0.eyJleHAiOjE3NjM2MTkxMDksImlhdCI6MTc2MzYxOTA0OSwianRpIjoib25sdHJvOmNkZmFmZjQ3LTY1ZWYtYTE2YS1mNWU2LTdlNmU3ZmNhN2ZjNCIsImlzcyI6Imh0dHA6Ly9rZXljbG9hay5sb2NhbGhvc3QvcmVhbG1zL21hc3RlciIsInR5cCI6IkJlYXJlciIsImF6cCI6ImFkbWluLWNsaSIsInNpZCI6ImFjNDNmNmUyLTY1YTYtMGNkZi1lYjUwLTNkOGVhMzZmMTNlOSIsInNjb3BlIjoiZW1haWwgcHJvZmlsZSJ9.gOBqzBQlJJWBf-IPaZrILlfNrf0_A7hzO_Cq0qRxE9p7lOCRjhlI9U701DfDsM0dyoqlzR1FKdVuV0c0ElZ2USOi6hpldX7jou5wzIk9B1en6wlZnUfveR774MLlQr3TzkSozBJmuPI2tu599Ec5zX46Qnoxvpx6jVRcm24ZsuxpUl5TkCPaHQtcS7vEbTMXTKBHoCQRASkm8DmHJsug4RjNqAANOe3LBoyZiO_pUq7N4g7Iue0rct4QnHKoqAc6r3cdrOe0vPpGV_6YNSGFcLwmRF5AU8a2fmHHSEjrcN_vzef-MqqWHqbv2_rsYH5Z4M65p36dHwSsRm-rXKv4vw",
                  "type": "string"
                },
                {
                  "key": "tokenName",
                  "value": "kc-admin-access",
                  "type": "string"
                },
                {
                  "key": "accessTokenUrl",
                  "value": "http://keycloak.localhost/realms/master/protocol/openid-connect/token",
                  "type": "string"
                },
                {
                  "key": "grant_type",
                  "value": "password_credentials",
                  "type": "string"
                },
                {
                  "key": "scope",
                  "value": "",
                  "type": "string"
                },
                {
                  "key": "clientId",
                  "value": "admin-cli",
                  "type": "string"
                },
                {
                  "key": "clientSecret",
                  "value": "",
                  "type": "string"
                },
                {
                  "key": "password",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "username",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "addTokenTo",
                  "value": "header",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"clientId\": \"{{participant_context_id}}\",\n    \"name\": \"{{participant_context_id}} Client\",\n    \"description\": \"Client for API access\",\n    \"enabled\": true,\n    \"secret\": \"{{participant_context_id}}-secret\",\n    \"protocol\": \"openid-connect\",\n    \"publicClient\": false,\n    \"serviceAccountsEnabled\": true,\n    \"standardFlowEnabled\": false,\n    \"directAccessGrantsEnabled\": false,\n    \"fullScopeAllowed\": true,\n    \"protocolMappers\": [\n        {\n            \"name\": \"participantContextId\",\n            \"protocol\": \"openid-connect\",\n            \"protocolMapper\": \"oidc-hardcoded-claim-mapper\",\n            \"consentRequired\": false,\n            \"config\": {\n                \"claim.name\": \"participant_context_id\",\n                \"claim.value\": \"{{participant_context_id}}\",\n                \"jsonType.label\": \"String\",\n                \"access.token.claim\": \"true\",\n                \"id.token.claim\": \"true\",\n                \"userinfo.token.claim\": \"true\"\n            }\n        },\n        {\n            \"name\": \"role\",\n            \"protocol\": \"openid-connect\",\n            \"protocolMapper\": \"oidc-hardcoded-claim-mapper\",\n            \"consentRequired\": false,\n            \"config\": {\n                \"claim.name\": \"role\",\n                \"claim.value\": \"participant\",\n                \"jsonType.label\": \"String\",\n                \"access.token.claim\": \"true\",\n                \"id.token.claim\": \"true\",\n                \"userinfo.token.claim\": \"true\"\n            }\n        }\n    ]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{KC_HOST}}/admin/realms/edcv/clients",
              "host": [
                "{{KC_HOST}}"
              ],
              "path": [
                "admin",
                "realms",
                "edcv",
                "clients"
              ]
            }
          }
        },
        {
          "name": "Create Holder in IssuerService",
          "id": "401047da-23e1-4923-a914-04c60cf50418",
          "request": {
            "auth": {
              "type": "apikey",
              "apikey": [
                {
                  "key": "value",
                  "value": "{{issuer_apiKey}}",
                  "type": "string"
                },
                {
                  "key": "key",
                  "value": "x-api-key",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"did\": \"{{participant_context_did}}\",\n    \"holderId\": \"{{participant_context_did}}\",\n    \"name\": \"{{participant_context_id}} tenant\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/issuer/admin/api/admin/v1alpha/participants/aXNzdWVy/holders",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "issuer",
                "admin",
                "api",
                "admin",
                "v1alpha",
                "participants",
                "aXNzdWVy",
                "holders"
              ]
            }
          }
        },
        {
          "name": "Create ParticipantContext in IdentityHub",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "16adc325-a09e-433c-b426-57ad929a1028",
                "exec": [
                  "// Parse JSON response and store clientId and clientSecret as collection variables",
                  "let jsonData;",
                  "",
                  "pm.test(\"Response is valid JSON\", function () {",
                  "    try {",
                  "        jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.be.an(\"object\");",
                  "    } catch (e) {",
                  "        throw new Error(\"Response body is not valid JSON\");",
                  "    }",
                  "});",
                  "",
                  "pm.test(\"Response contains apiKey, clientId and clientSecret\", function () {",
                  "    pm.expect(jsonData).to.have.property(\"clientId\");",
                  "    pm.expect(jsonData).to.have.property(\"clientSecret\");",
                  "    pm.expect(jsonData).to.have.property(\"apiKey\");",
                  "});",
                  "",
                  "if (jsonData && jsonData.clientId && jsonData.clientSecret) {",
                  "    pm.collectionVariables.set(\"tenant_clientId\", jsonData.clientId);",
                  "    pm.collectionVariables.set(\"tenant_clientSecret\", jsonData.clientSecret);",
                  "    pm.collectionVariables.set(\"tenant_apiKey\", jsonData.apiKey);",
                  "} "
                ],
                "type": "text/javascript"
              }
            }
          ],
          "id": "04d6f06e-cfa8-468e-b3e7-5678fba9d016",
          "request": {
            "auth": {
              "type": "apikey",
              "apikey": [
                {
                  "key": "value",
                  "value": "c3VwZXItdXNlcg==.c3VwZXItc2VjcmV0LWtleQo=",
                  "type": "string"
                },
                {
                  "key": "key",
                  "value": "x-api-key",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"roles\": [],\n    \"serviceEndpoints\": [\n        {\n            \"type\": \"CredentialService\",\n            \"serviceEndpoint\": \"http://identityhub.edc-v.svc.cluster.local:7082/api/credentials/v1/participants/{{participant_context_id_base64}}\",\n            \"id\": \"{{participant_context_id}}-credentialservice-1\"\n        },\n        {\n            \"type\": \"ProtocolEndpoint\",\n            \"serviceEndpoint\": \"http://controlplane.edc-v.svc.cluster.local:8082/api/dsp/{{participant_context_id}}/2025-1\",\n            \"id\": \"{{participant_context_id}}-dsp\"\n        }\n    ],\n    \"active\": true,\n    \"participantContextId\": \"{{participant_context_id}}\",\n    \"did\": \"{{participant_context_did}}\",\n    \"key\": {\n        \"keyId\": \"{{participant_context_did}}#key-1\",\n        \"privateKeyAlias\": \"{{participant_context_did}}#key-1\",\n        \"keyGeneratorParams\": {\n            \"algorithm\": \"EC\"\n        }\n    },\n    \"additionalProperties\": {\n        \"vaultConfig\": {\n            \"credentials\": {\n                \"clientId\": \"{{participant_context_id}}-vault\",\n                \"clientSecret\": \"{{participant_context_id}}-secret\",\n                \"tokenUrl\": \"http://keycloak.edc-v.svc.cluster.local:8080/realms/edcv/protocol/openid-connect/token\"\n            },\n            \"secretsPath\": \"v1/participants\",\n            \"folderPath\": \"{{participant_context_id}}/identityhub\",\n            \"vaultUrl\": \"http://vault.edc-v.svc.cluster.local:8200\"\n        }\n    }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/cs/api/identity/v1alpha/participants",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "cs",
                "api",
                "identity",
                "v1alpha",
                "participants"
              ]
            }
          }
        },
        {
          "name": "Create ParticipantContext in Control Plane",
          "id": "fd518f1d-baa1-42aa-b1b4-4699db465b17",
          "request": {
            "auth": {
              "type": "oauth2",
              "oauth2": [
                {
                  "key": "clientId",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "tokenName",
                  "value": "admin-access",
                  "type": "string"
                },
                {
                  "key": "clientSecret",
                  "value": "edc-v-admin-secret",
                  "type": "string"
                },
                {
                  "key": "scope",
                  "value": "management-api:read management-api:write identity-api:read identity-api:write",
                  "type": "string"
                },
                {
                  "key": "accessTokenUrl",
                  "value": "http://keycloak.localhost/realms/edcv/protocol/openid-connect/token",
                  "type": "string"
                },
                {
                  "key": "grant_type",
                  "value": "client_credentials",
                  "type": "string"
                },
                {
                  "key": "tokenType",
                  "value": "Bearer",
                  "type": "string"
                },
                {
                  "key": "password",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "username",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "addTokenTo",
                  "value": "header",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"participantContextId\": \"{{participant_context_id}}\",\n    \"participantId\": \"{{participant_context_did}}\",\n    \"isActive\": true,\n    \"tokenUrl\": \"http://identityhub.edc-v.svc.cluster.local:7084/api/sts/token\",\n    \"clientSecret\": \"{{tenant_clientSecret}}\",\n    \"clientId\": \"{{tenant_clientId}}\",\n    \"vaultConfig\": {\n        \"credentials\": {\n            \"clientId\": \"{{participant_context_id}}-vault\",\n            \"clientSecret\": \"{{participant_context_id}}-secret\",\n            \"tokenUrl\": \"http://keycloak.edc-v.svc.cluster.local:8080/realms/edcv/protocol/openid-connect/token\"\n        },\n        \"secretsPath\": \"v1/participants\",\n        \"folderPath\": \"{{participant_context_id}}/identityhub\",\n        \"vaultUrl\": \"http://vault.edc-v.svc.cluster.local:8200\"\n    }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/cp/api/mgmt/v1alpha/participants",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "cp",
                "api",
                "mgmt",
                "v1alpha",
                "participants"
              ]
            }
          }
        },
        {
          "name": "Request Credentials",
          "id": "84286478-c818-4578-9817-8f5771305d14",
          "request": {
            "auth": {
              "type": "apikey",
              "apikey": [
                {
                  "key": "value",
                  "value": "c3VwZXItdXNlcg==.c3VwZXItc2VjcmV0LWtleQo=",
                  "type": "string"
                },
                {
                  "key": "key",
                  "value": "x-api-key",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"issuerDid\": \"did:web:issuerservice.edc-v.svc.cluster.local%3A10016:issuer\",\n    \"holderPid\": \"credential-request-1\",\n    \"credentials\": [{\n        \"format\": \"VC1_0_JWT\",\n        \"type\": \"MembershipCredential\",\n        \"id\": \"membership-credential-def\"\n    }]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/cs/api/identity/v1alpha/participants/{{participant_context_id_base64}}/credentials/request",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "cs",
                "api",
                "identity",
                "v1alpha",
                "participants",
                "{{participant_context_id_base64}}",
                "credentials",
                "request"
              ]
            }
          }
        }
      ],
      "id": "46a3a829-876f-4875-bc30-d4fa4389435a"
    },
    {
      "name": "Data Transfer",
      "item": [
        {
          "name": "Get Catalog",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "67ec4dcb-bea2-4f76-a6ca-85243eff6943",
                "exec": [
                  "try {",
                  "    const json = pm.response.json();",
                  "",
                  "    // Navigate the expected structure: Catalog -> dataset[0] -> hasPolicy[0] -> @id",
                  "    const datasets = json.dataset || [];",
                  "    const firstDataset = datasets[0] || {};",
                  "    const policies = firstDataset.hasPolicy || [];",
                  "    const firstPolicy = policies[0] || {};",
                  "    const policyId = firstPolicy['@id'];",
                  "",
                  "    if (policyId && typeof policyId === 'string') {",
                  "        pm.collectionVariables.set('POLICY_ID', policyId);",
                  "        console.log('POLICY_ID set to:', policyId);",
                  "    } else {",
                  "        console.warn('Policy ID not found in response at dataset[0].hasPolicy[0][\"@id\"]');",
                  "    }",
                  "",
                  "    // Optional: assertion to ensure it exists",
                  "    pm.test('Policy ID is present and stored', function () {",
                  "        pm.expect(policyId, 'Policy ID should exist').to.be.a('string').and.not.empty;",
                  "    });",
                  "",
                  "} catch (e) {",
                  "    console.error('Failed to parse response or set POLICY_ID:', e);",
                  "    pm.test('Response is valid JSON', function () {",
                  "        throw e;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "id": "aa9229a3-4e30-4ce4-8a87-afea5a5aa38f",
          "request": {
            "auth": {
              "type": "oauth2",
              "oauth2": [
                {
                  "key": "scope",
                  "value": "management-api:read",
                  "type": "string"
                },
                {
                  "key": "clientSecret",
                  "value": "consumer-secret",
                  "type": "string"
                },
                {
                  "key": "clientId",
                  "value": "consumer",
                  "type": "string"
                },
                {
                  "key": "accessTokenUrl",
                  "value": "http://keycloak.localhost/realms/edcv/protocol/openid-connect/token",
                  "type": "string"
                },
                {
                  "key": "grant_type",
                  "value": "client_credentials",
                  "type": "string"
                },
                {
                  "key": "tokenName",
                  "value": "edcv-participan",
                  "type": "string"
                },
                {
                  "key": "tokenType",
                  "value": "Bearer",
                  "type": "string"
                },
                {
                  "key": "accessToken",
                  "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI1RDVSVlVKU0txTVhkZGl5Y3J5OUNwMkU0azRaQi1BMXlkMjdaOWZGcWVFIn0.eyJleHAiOjE3NjI4NDEzMzUsImlhdCI6MTc2Mjg0MTAzNSwianRpIjoidHJydGNjOmU0ZTBjNjk2LWU5MjktMDNmOC03NGRmLWQxNDQ0ZTEwMDhkYiIsImlzcyI6Imh0dHA6Ly9rZXljbG9hay5sb2NhbGhvc3QvcmVhbG1zL2VkY3YiLCJzdWIiOiJhZjgyOTVmNC0zYmRjLTRhOWMtODVkMi1lZDc3NzgxMTdiMDEiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJjb25zdW1lciIsInNjb3BlIjoibWFuYWdlbWVudC1hcGk6d3JpdGUgbWFuYWdlbWVudC1hcGk6cmVhZCIsInJvbGUiOiJlZGN2LXBhcnRpY2lwYW50IiwicGFydGljaXBhbnRfY29udGV4dF9pZCI6ImNvbnN1bWVyIn0.XBJZTav8iasC_CGqbfulxXLDzCk_EYmdgTuM02Jhpmu5AlKEF9LGL4tXE0-Tu_dlpaq5gaIMpu1QvwYYbo2y79AiTY-oNCTX9T4PWOSlEXiaHe8-QESWlFx_JRolpNL4rSdIiZlUgsGqrPWmJfWpvNArGM0hl41fZE4tMqX7wjP3JpK8R50M7ApEDRlBx4sm44ItxyZ5TFGYSNXSGT9eM_lnsAynPB6wQcIuk20mdp1NrYR8tN3xZj_4nSc2OrHZGwd1AN07FNKhYXS66w5lkIuB1S8OHM_h0nUcBX887IOqP1GDlBreir41c38bddg4I34JH2QZeTKBqljfTQoVMg",
                  "type": "string"
                },
                {
                  "key": "password",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "username",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "addTokenTo",
                  "value": "header",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n\"counterPartyDid\":\"did:web:identityhub.edc-v.svc.cluster.local%3A7083:provider\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/cp/api/mgmt/v1alpha/participants/consumer/catalog",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "cp",
                "api",
                "mgmt",
                "v1alpha",
                "participants",
                "consumer",
                "catalog"
              ]
            }
          }
        },
        {
          "name": "Get Data",
          "id": "0f2f60d4-155d-4e0a-9975-2ac58df8058c",
          "request": {
            "auth": {
              "type": "oauth2",
              "oauth2": [
                {
                  "key": "tokenName",
                  "value": "kc-admin-access",
                  "type": "string"
                },
                {
                  "key": "tokenType",
                  "value": "Bearer",
                  "type": "string"
                },
                {
                  "key": "accessTokenUrl",
                  "value": "http://keycloak.localhost/realms/master/protocol/openid-connect/token",
                  "type": "string"
                },
                {
                  "key": "grant_type",
                  "value": "password_credentials",
                  "type": "string"
                },
                {
                  "key": "scope",
                  "value": "",
                  "type": "string"
                },
                {
                  "key": "clientId",
                  "value": "admin-cli",
                  "type": "string"
                },
                {
                  "key": "clientSecret",
                  "value": "",
                  "type": "string"
                },
                {
                  "key": "password",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "username",
                  "value": "admin",
                  "type": "string"
                },
                {
                  "key": "addTokenTo",
                  "value": "header",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n    \"providerId\":\"did:web:identityhub.edc-v.svc.cluster.local%3A7083:provider\",\n    \"policyId\": \"{{POLICY_ID}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/cp/api/mgmt/v1alpha/participants/consumer/data",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "cp",
                "api",
                "mgmt",
                "v1alpha",
                "participants",
                "consumer",
                "data"
              ]
            }
          }
        }
      ],
      "id": "4b62166a-59f8-4b9f-a996-09b11b6331da"
    },
    {
      "name": "Experimental",
      "item": [
        {
          "name": "Get Asset (using new Mgmt API)",
          "id": "0db6b7f7-d414-414f-ab88-8c500f1c26f1",
          "request": {
            "auth": {
              "type": "oauth2",
              "oauth2": [
                {
                  "key": "tokenType",
                  "value": "Bearer",
                  "type": "string"
                },
                {
                  "key": "accessToken",
                  "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI0WWtQM0dTdGVvV0xpNzdlTmdzWHJsNlZDd1dUUFBBUXhkMjdPQnQxQUxJIn0.eyJleHAiOjE3NjI1MTk1OTEsImlhdCI6MTc2MjUxOTUzMSwianRpIjoib25sdHJ0OjRiMmVkODViLTIzZmYtMGUxNC0yODFmLTMyNWUxZmQ1NmQ0OSIsImlzcyI6Imh0dHA6Ly9rZXljbG9hay5sb2NhbGhvc3QvcmVhbG1zL21hc3RlciIsInR5cCI6IkJlYXJlciIsImF6cCI6ImFkbWluLWNsaSIsInNpZCI6IjQ1NDljMWJmLWIxM2ItMDVjMy1mNDkwLWRlNmUyYmJjNmFkNSIsInNjb3BlIjoiZW1haWwgcHJvZmlsZSJ9.S8GPWfWyudk0Zh0orHk8LOutDXmL1hhUWcOAG7jzcYjko8eMAEtBqoqTivNUVyorIfk-J1ohwrlNuBE_dQzm9QzlS01UEyERkZmksBEyHmzMauA9IF3SyDMqeuIDpyTWU0zuWZtnOgaatsrETVqPHifMXbB5E1XkGQtHLIbxiukBSwG8aydA_jKkgC2A53Gu6lIgYGwZAiergO_nliWkXily_GvZZY3GY6KOKAM_gZwTPR8ppkeABZP0xNAeW-K_RnkhvfTQs0bHTyCZ910z21sM1kJTKGSCbSi7ejPMprZnqIqVogKSo2gvCp40pmKWs6cE-aK0BxvmNHSgsi-wyg",
                  "type": "string"
                },
                {
                  "key": "clientSecret",
                  "value": "consumer-secret",
                  "type": "string"
                },
                {
                  "key": "accessTokenUrl",
                  "value": "http://keycloak.localhost/realms/edcv/protocol/openid-connect/token",
                  "type": "string"
                },
                {
                  "key": "scope",
                  "value": "management-api:write management-api:read",
                  "type": "string"
                },
                {
                  "key": "clientId",
                  "value": "consumer",
                  "type": "string"
                },
                {
                  "key": "grant_type",
                  "value": "client_credentials",
                  "type": "string"
                },
                {
                  "key": "tokenName",
                  "value": "edc-v-access",
                  "type": "string"
                },
                {
                  "key": "addTokenTo",
                  "value": "header",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "url": {
              "raw": "{{baseURL}}/cp/api/mgmt/v4alpha/participants/consumer/assets/d61e6755-3594-48e6-9106-b670211deb6e",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "cp",
                "api",
                "mgmt",
                "v4alpha",
                "participants",
                "consumer",
                "assets",
                "d61e6755-3594-48e6-9106-b670211deb6e"
              ]
            }
          }
        },
        {
          "name": "Create Asset (using new Mgmt API)",
          "id": "9ab06caa-10c9-4620-885f-14de41b19ac9",
          "request": {
            "auth": {
              "type": "oauth2",
              "oauth2": [
                {
                  "key": "accessTokenUrl",
                  "value": "http://keycloak.localhost/realms/edcv/protocol/openid-connect/token",
                  "type": "string"
                },
                {
                  "key": "clientSecret",
                  "value": "1KjSm7GixsOp4PDG4fyqGNbFJKiiuisH",
                  "type": "string"
                },
                {
                  "key": "scope",
                  "value": "management-api:write management-api:read",
                  "type": "string"
                },
                {
                  "key": "clientId",
                  "value": "consumer",
                  "type": "string"
                },
                {
                  "key": "grant_type",
                  "value": "client_credentials",
                  "type": "string"
                },
                {
                  "key": "tokenName",
                  "value": "edc-v-access",
                  "type": "string"
                },
                {
                  "key": "addTokenTo",
                  "value": "header",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"@context\": [\n    \"https://w3id.org/edc/connector/management/v0.0.1\"\n  ],\n  \"@id\": \"asset-1\",\n  \"@type\": \"Asset\",\n  \"properties\": {\n    \"description\": \"This asset requires Membership to view and negotiate.\"\n  },\n  \"dataAddress\": {\n    \"@type\": \"DataAddress\",\n    \"type\": \"HttpData\",\n    \"baseUrl\": \"https://jsonplaceholder.typicode.com/todos\",\n    \"proxyPath\": \"true\",\n    \"proxyQueryParams\": \"true\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseURL}}/cp/api/mgmt/v4alpha/participants/consumer/assets",
              "host": [
                "{{baseURL}}"
              ],
              "path": [
                "cp",
                "api",
                "mgmt",
                "v4alpha",
                "participants",
                "consumer",
                "assets"
              ]
            }
          }
        }
      ],
      "id": "604d7148-8325-467d-855f-9c67b5eec122"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "id": "2fbaeffb-e27b-445f-b6e5-bb2202518cf8",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "id": "38dfd7ad-5d54-4cd7-b888-06725386af60",
        "type": "text/javascript",
        "exec": [
          "// Append-only: status code is any 2xx or 409, considering numeric and string descriptions",
          "pm.test(\"Status code is 2xx or 409\", function () {",
          "    const code = pm.response.code; // numeric",
          "",
          "    const is2xx = code >= 200 && code < 300;",
          "    const is409 = code === 409;",
          "",
          "    pm.expect(is2xx || is409, `Expected 2xx or 409. Got ${code} ${pm.response.status}`).to.be.true;",
          "});"
        ]
      }
    }
  ],
  "variable": [
    {
      "id": "71a80acf-a10b-488f-8361-f6de2c7848f3",
      "key": "baseURL",
      "value": "http://localhost"
    },
    {
      "id": "e0d12c16-3a37-46ca-8b8d-f0940b0b85f0",
      "key": "issuer_apiKey",
      "value": ""
    },
    {
      "id": "259e0170-7d5f-4474-ad0d-a7ffc95f076d",
      "key": "issuer_clientId",
      "value": ""
    },
    {
      "id": "3a1b15b7-9e96-4d63-bb6b-1a1a49bf40a8",
      "key": "issuer_clientSecret",
      "value": ""
    },
    {
      "id": "eb20ff07-7ed8-43c7-bc76-6b7a0774d6a0",
      "key": "tenant_clientId",
      "value": ""
    },
    {
      "id": "256adbe5-d6cb-423b-96d6-d523d7f65213",
      "key": "tenant_clientSecret",
      "value": ""
    },
    {
      "id": "0444c01e-beb7-4d98-8ee7-b7588d78cae0",
      "key": "tenant_apiKey",
      "value": ""
    },
    {
      "id": "6bf65343-8d69-40e8-88ea-af007e0c8e3d",
      "key": "POLICY_ID",
      "value": ""
    },
    {
      "id": "54a52cf9-56b5-47ab-b7cc-3fc7170d9469",
      "key": "KC_HOST",
      "value": "http://keycloak.localhost"
    },
    {
      "id": "030435ac-cb89-4ea5-ac67-05395971235e",
      "key": "VAULT_HOST",
      "value": "http://vault.localhost"
    },
    {
      "id": "83b47c4c-64af-4b31-96af-285c2a5e85f6",
      "key": "participant_context_id",
      "value": ""
    },
    {
      "id": "792dfaf4-3695-4697-9fe1-f216781f79ee",
      "key": "participant_context_did",
      "value": ""
    },
    {
      "id": "49fabaac-f37a-446b-8dd6-6162bf4fa35b",
      "key": "participant_context_id_base64",
      "value": ""
    }
  ]
}